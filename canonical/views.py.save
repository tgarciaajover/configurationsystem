from django.shortcuts import render

from rest_framework import status
from rest_framework.decorators import api_view
from rest_framework.response import Response

from canonical.models import Compania
from canonical.serializers import CompaniaSerializer
from canonical.serializers import SedeSerializer
from canonical.serializers import PlantaSerializer
from canonical.serializers import RazonParadaSerializer
from canonical.serializers import GrupoMaquinaSerializer
from canonical.serializers import MaquinaSerializer
from canonical.serializers import PlanProductionSerializer
from canonical.serializers import OrdenProduccionPlaneadaSerializer
from canonical.serializers import ParadaPlaneadaSerializer

@api_view(['GET', 'POST'])
def compania_list(request, format=None):
    """
    Lista todas las companias, or crea una nueva compania.
    """
    if request.method == 'GET':
        companias = Compania.objects.all()
        serializer = CompaniaSerializer(companias, many=True)
        return Response(serializer.data)

    elif request.method == 'POST':
        serializer = CompaniaSerializer(data=request.data)
        if serializer.is_valid():
            serializer.save()
            return Response(serializer.data, status=status.HTTP_201_CREATED)
        return Response(serializer.errors, status=status.HTTP_400_BAD_REQUEST)

@api_view(['GET', 'PUT', 'DELETE'])
def compania_detail(request, pk, format=None):
    """
    Obtiene, actualiza or borra una compania.
    """
    try:
        compania = Compania.objects.get(pk=pk)
    except Compania.DoesNotExist:
        return Response(status=status.HTTP_404_NOT_FOUND)

    if request.method == 'GET':
        serializer = CompaniaSerializer(compania)
        return Response(serializer.data)

    elif request.method == 'PUT':
        serializer = CompaniaSerializer(compania, data=request.data)
        if serializer.is_valid():
            serializer.save()
            return Response(serializer.data)
        return Response(serializer.errors, status=status.HTTP_400_BAD_REQUEST)

    elif request.method == 'DELETE':
        compania.delete()
        return Response(status=status.HTTP_204_NO_CONTENT)


@api_view(['GET', 'POST'])
sededef sede_list(request, format=None):
    """
    Lista todas las sedes, or crea una nueva sede.
    """
    if request.method == 'GET':
        sedes = Sede.objects.all()
        serializer = SedeSerializer(sedes, many=True)
        return Response(serializer.data)

    elif request.method == 'POST':
        serializer = SedeSerializer(data=request.data)
        if serializer.is_valid():
            serializer.save()
            return Response(serializer.data, status=status.HTTP_201_CREATED)
        return Response(serializer.errors, status=status.HTTP_400_BAD_REQUEST)

@api_view(['GET', 'PUT', 'DELETE'])
def sede_detail(request, pk, format=None):
    """
    Obtiene, actualiza or borra una sede.
    """
    try:
        sede = Sede.objects.get(pk=pk)
    except Sede.DoesNotExist:
        return Response(status=status.HTTP_404_NOT_FOUND)

    if request.method == 'GET':
        serializer = SedeSerializer(sede)
        return Response(serializer.data)

    elif request.method == 'PUT':
        serializer = SedeSerializer(sede, data=request.data)
        if serializer.is_valid():
            serializer.save()
            return Response(serializer.data)
        return Response(serializer.errors, status=status.HTTP_400_BAD_REQUEST)

    elif request.method == 'DELETE':
        sede.delete()
        return Response(status=status.HTTP_204_NO_CONTENT)

@api_view(['GET', 'POST'])
def planta_list(request, format=None):
    """
    Lista todas las plantas, or crea una nueva planta.
    """
    if request.method == 'GET':
        plantas = Planta.objects.all()
        serializer = PlantaSerializer(plantas, many=True)
        return Response(serializer.data)

    elif request.method == 'POST':
        serializer = PlantaSerializer(data=request.data)
        if serializer.is_valid():
            serializer.save()
            return Response(serializer.data, status=status.HTTP_201_CREATED)
        return Response(serializer.errors, status=status.HTTP_400_BAD_REQUEST)

@api_view(['GET', 'PUT', 'DELETE'])
def planta_detail(request, pk, format=None):
    """
    Obtiene, actualiza or borra una planta.
    """
    try:
        planta = Planta.objects.get(pk=pk)
    except Planta.DoesNotExist:
        return Response(status=status.HTTP_404_NOT_FOUND)

    if request.method == 'GET':
        serializer = PlantaSerializer(planta)
        return Response(serializer.data)

    elif request.method == 'PUT':
        serializer = PlantaSerializer(planta, data=request.data)
        if serializer.is_valid():
            serializer.save()
            return Response(serializer.data)
        return Response(serializer.errors, status=status.HTTP_400_BAD_REQUEST)

    elif request.method == 'DELETE':
        planta.delete()
        return Response(status=status.HTTP_204_NO_CONTENT)

@api_view(['GET', 'POST'])
def razon_parada_list(request, format=None):
    """
    Lista todas las razones de parada, or crea una nueva razon de parada.
    """
    if request.method == 'GET':
        razonesparada = RazonParada.objects.all()
        serializer = RazonParadaSerializer(razonesparada, many=True)
        return Response(serializer.data)

    elif request.method == 'POST':
        serializer = RazonParadaSerializer(data=request.data)
        if serializer.is_valid():
            serializer.save()
            return Response(serializer.data, status=status.HTTP_201_CREATED)
        return Response(serializer.errors, status=status.HTTP_400_BAD_REQUEST)

@api_view(['GET', 'PUT', 'DELETE'])
def razon_parada_detail(request, pk, format=None):
    """
    Obtiene, actualiza or borra una razon de parada.
    """
    try:
        razonparada = RazonParada.objects.get(pk=pk)
    except RazonParada.DoesNotExist:
        return Response(status=status.HTTP_404_NOT_FOUND)

    if request.method == 'GET':
        serializer = RazonParadaSerializer(razonparada)
        return Response(serializer.data)

    elif request.method == 'PUT':
        serializer = RazonParadaSerializer(razonparada, data=request.data)
        if serializer.is_valid():
            serializer.save()
            return Response(serializer.data)
        return Response(serializer.errors, status=status.HTTP_400_BAD_REQUEST)

    elif request.method == 'DELETE':
        razonparada.delete()
        return Response(status=status.HTTP_204_NO_CONTENT)

@api_view(['GET', 'POST'])
def grupo_maquina_list(request, format=None):
    """
    Lista todas los grupos de maquina, or crea un nuevo grupo de maquina.
    """
    if request.method == 'GET':
        grupomaquina = GrupoMaquina.objects.all()
        serializer = GrupoMaquinaSerializer(grupomaquina, many=True)
        return Response(serializer.data)

    elif request.method == 'POST':
        serializer = GrupoMaquinaSerializer(data=request.data)
        if serializer.is_valid():
            serializer.save()
            return Response(serializer.data, status=status.HTTP_201_CREATED)
        return Response(serializer.errors, status=status.HTTP_400_BAD_REQUEST)

@api_view(['GET', 'PUT', 'DELETE'])
def grupo_maquina_detail(request, pk, format=None):
    """
    Obtiene, actualiza or borra un grupo de maquina.
    """
    try:
        grupomaquina = GrupoMaquina.objects.get(pk=pk)
    except GrupoMaquina.DoesNotExist:
        return Response(status=status.HTTP_404_NOT_FOUND)

    if request.method == 'GET':
        serializer = GrupoMaquinaSerializer(grupomaquina)
        return JsonResponse(serializer.data)

    elif request.method == 'PUT':
        serializer = GrupoMaquinaSerializer(grupomaquina, data=request.data)
        if serializer.is_valid():
            serializer.save()
            return Response(serializer.data)
        return Response(serializer.errors, status=status.HTTP_400_BAD_REQUEST)

    elif request.method == 'DELETE':
        grupomaquina.delete()
        return Response(status=status.HTTP_204_NO_CONTENT)

@api_view(['GET', 'POST'])
def maquina_list(request, format=None):
    """
    Lista todas las maquinas, or crea una nueva maquina.
    """
    if request.method == 'GET':
        maquina = Maquina.objects.all()
        serializer = MaquinaSerializer(maquina, many=True)
        return Response(serializer.data)

    elif request.method == 'POST':
        serializer = MaquinaSerializer(data=request.data)
        if serializer.is_valid():
            serializer.save()
            return Response(serializer.data, status=status.HTTP_201_CREATED)
        return Response(serializer.errors, status=status.HTTP_400_BAD_REQUEST)

@api_view(['GET', 'PUT', 'DELETE'])
def maquina_detail(request, pk, format=None):
    """
    Obtiene, actualiza or borra una maquina.
    """
    try:
        maquina = Maquina.objects.get(pk=pk)
    except Maquina.DoesNotExist:
        return Response(status=status.HTTP_404_NOT_FOUND)

    if request.method == 'GET':
        serializer = MaquinaSerializer(maquina)
        return Response(serializer.data)

    elif request.method == 'PUT':
        serializer = MaquinaSerializer(maquina, data=request.data)
        if serializer.is_valid():
            serializer.save()
            return Response(serializer.data)
        return Response(serializer.errors, status=status.HTTP_400_BAD_REQUEST)

    elif request.method == 'DELETE':
        maquina.delete()
        return Response(status=status.HTTP_204_NO_CONTENT)

@api_view(['GET', 'POST'])
def plan_produccion_list(request, format=None):
    """
    Lista todos los planes de produccion, or crea un nuevo plan de produccion.
    """
    if request.method == 'GET':
        planproduccion = PlanProduccion.objects.all()
        serializer = PlanProduccionSerializer(planproduccion, many=True)
        return Response(serializer.data)

    elif request.method == 'POST':
        serializer = PlanProduccionSerializer(data=request.data)
        if serializer.is_valid():
            serializer.save()
            return Response(serializer.data, status=status.HTTP_201_CREATED)
        return Response(serializer.errors, status=status.HTTP_400_BAD_REQUEST)

@api_view(['GET', 'PUT', 'DELETE'])
def plan_produccion_detail(request, pk, format=None):
    """
    Obtiene, actualiza or borra un plan de produccion.
    """
    try:
        planproduccion = PlanProduccion.objects.get(pk=pk)
    except PlanProduccion.DoesNotExist:
        return Response(status=status.HTTP_404_NOT_FOUND)

    if request.method == 'GET':
        serializer = PlanProduccionSerializer(planproduccion)
        return Response(serializer.data)

    elif request.method == 'PUT':
        serializer = PlanProduccionSerializer(planproduccion, data=request.data)
        if serializer.is_valid():
            serializer.save()
            return Response(serializer.data)
        return Response(serializer.errors, status=status.HTTP_400_BAD_REQUEST)

    elif request.method == 'DELETE':
        planproduccion.delete()
        return Response(status=status.HTTP_204_NO_CONTENT)

@api_view(['GET', 'POST'])
def orden_produccion_planeada_list(request, format=None):
    """
    Lista todos las ordenes de produccion planeada, or crea una nueva orden de produccion planeada.
    """
    if request.method == 'GET':
        ordenproduccionplaneada = OrdenProduccionPlaneada.objects.all()
        serializer = OrdenProduccionPlaneadaSerializer(ordenproduccionplaneada, many=True)
        return Response(serializer.data)

    elif request.method == 'POST':
        serializer = OrdenProduccionPlaneadaSerializer(data=request.data)
        if serializer.is_valid():
            serializer.save()
            return Response(serializer.data, status=status.HTTP_201_CREATED)
        return Response(serializer.errors, status=status.HTTP_400_BAD_REQUEST)

@api_view(['GET', 'PUT', 'DELETE'])
def orden_produccion_planeada_detail(request, pk, format=None):
    """
    Obtiene, actualiza or borra una order de produccion planeada.
    """
    try:
        ordenproduccionplaneada = OrdenProduccionPlaneada.objects.get(pk=pk)
    except OrdenProduccionPlaneada.DoesNotExist:
        return Response(status=status.HTTP_404_NOT_FOUND)

    if request.method == 'GET':
        serializer = OrdenProduccionPlaneadaSerializer(ordenproduccionplaneada)
        return Response(serializer.data)

    elif request.method == 'PUT':
        serializer = OrdenProduccionPlaneadaSerializer(ordenproduccionplaneada, data=request.data)
        if serializer.is_valid():
            serializer.save()
            return Response(serializer.data)
        return Response(serializer.errors, status=status.HTTP_400_BAD_REQUEST)

    elif request.method == 'DELETE':
        ordenproduccionplaneada.delete()
        return Response(status=status.HTTP_204_NO_CONTENT)

@api_view(['GET', 'POST'])
def parada_planeada_list(request, format=None):
    """
    Lista todos las paradas planeadas, or crea una nueva parada planeada.
    """
    if request.method == 'GET':
        paradaplaneada = ParadaPlaneada.objects.all()
        serializer = ParadaPlaneadaSerializer(paradaplaneada, many=True)
        return Response(serializer.data)

    elif request.method == 'POST':
        serializer = ParadaPlaneadaSerializer(data=request.data)
        if serializer.is_valid():
            serializer.save()
            return Response(serializer.data, status=status.HTTP_201_CREATED)
        return Response(serializer.errors, status=status.HTTP_400_BAD_REQUEST)

@api_view(['GET', 'PUT', 'DELETE'])
def orden_produccion_planeada_detail(request, pk, format=None):
    """
    Obtiene, actualiza or borra una parada planeada.
    """
    try:
        paradaplaneada = ParadaPlaneada.objects.get(pk=pk)
    except ParadaPlaneada.DoesNotExist:
        return Response(status=status.HTTP_404_NOT_FOUND)

    if request.method == 'GET':
        serializer = ParadaPlaneadaSerializer(paradaplaneada)
        return Response(serializer.data)

    elif request.method == 'PUT':
        serializer = ParadaPlaneadaSerializer(paradaplaneada, data=request.data)
        if serializer.is_valid():
            serializer.save()
            return Response(serializer.data)
        return Response(serializer.errors, status=status.HTTP_400_BAD_REQUEST)

    elif request.method == 'DELETE':
        paradaplaneada.delete()
        return Response(status=status.HTTP_204_NO_CONTENT)
